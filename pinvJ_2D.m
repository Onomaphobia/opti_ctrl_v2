function [pinvJ] = pinvJ_2D(L1,L2,L3,theta1,theta2,theta3)

pinvJ =  [                                                                                                                                                                                                                                                        (L3^2*abs(L1)^2*abs(L2)^2*sind(theta1 + theta3 + 2*real(theta2)) - L2^2*sind(theta1 + theta2 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 + L2^2*sind(theta1 + 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L3)^2 - L3^2*sind(theta1 + theta2 + theta3 - conj(theta2))*abs(L1)^2*abs(L2)^2 - L2*L3*abs(L1)^2*abs(L2)^2*sind(theta1 + theta2 - conj(theta2)) - L1*L3*sind(theta1 + theta2 + theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2 + L2*L3*sind(theta1 + 2*real(theta2))*abs(L1)^2*abs(L2)^2 + 2*L2*L3*sind(theta1 + 2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2 - 2*L2*L3*sind(theta1 + theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 + L1*L3*abs(L2)^2*abs(L3)^2*sind(theta1 + theta2 + 2*real(theta3)))/(2*(L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta2)*sind(theta3) + L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta3)*sind(theta2) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + L1*L2*L3*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*sind(theta2) + 2*L1*L2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*sind(theta3) + L1*L2^2*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta2) + L1*L2^2*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta2) + L2^2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta3) + L2^2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2))),                                                                                                                                                                                                                                                        (L2^2*cosd(theta1 + theta2 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 - L2^2*cosd(theta1 + 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L3)^2 + L3^2*cosd(theta1 + theta2 + theta3 - conj(theta2))*abs(L1)^2*abs(L2)^2 - L3^2*abs(L1)^2*abs(L2)^2*cosd(theta1 + theta3 + 2*real(theta2)) + L1*L3*cosd(theta1 + theta2 + theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2 - L2*L3*cosd(theta1 + 2*real(theta2))*abs(L1)^2*abs(L2)^2 - 2*L2*L3*cosd(theta1 + 2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2 + 2*L2*L3*cosd(theta1 + theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 - L1*L3*abs(L2)^2*abs(L3)^2*cosd(theta1 + theta2 + 2*real(theta3)) + L2*L3*abs(L1)^2*abs(L2)^2*cosd(theta1 + theta2 - conj(theta2)))/(2*(L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta2)*sind(theta3) + L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta3)*sind(theta2) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + L1*L2*L3*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*sind(theta2) + 2*L1*L2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*sind(theta3) + L1*L2^2*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta2) + L1*L2^2*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta2) + L2^2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta3) + L2^2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2)));
           -(L3^2*abs(L1)^2*abs(L2)^2*sind(theta1 + theta3 + 2*real(theta2)) - L2^2*sind(theta1 + theta2 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 + L2^2*sind(theta1 + 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L3)^2 - L3^2*sind(theta1 + theta2 + theta3 - conj(theta2))*abs(L1)^2*abs(L2)^2 - L2*L3*abs(L1)^2*abs(L2)^2*sind(theta1 + theta2 - conj(theta2)) + L1*L2*abs(L1)^2*abs(L3)^2*sind(theta1 + conj(theta2) + conj(theta3)) + L1*L3*sind(theta1 + conj(theta2))*abs(L1)^2*abs(L2)^2 + L1*L2*sind(conj(theta2) - theta1 + conj(theta3))*abs(L1)^2*abs(L3)^2 + L1*L3*sind(theta1 + theta2 + theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2 + L2*L3*sind(theta1 + 2*real(theta2))*abs(L1)^2*abs(L2)^2 - L1*L3*sind(theta1 - conj(theta2))*abs(L1)^2*abs(L2)^2 + L2*L3*sind(theta1 + 2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2 - L2*L3*sind(theta1 + theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 - L1*L3*abs(L2)^2*abs(L3)^2*sind(theta1 + theta2 + 2*real(theta3)))/(2*(L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta2)*sind(theta3) + L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta3)*sind(theta2) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + L1*L2*L3*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*sind(theta2) + 2*L1*L2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*sind(theta3) + L1*L2^2*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta2) + L1*L2^2*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta2) + L2^2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta3) + L2^2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2))), -(L2^2*cosd(theta1 + theta2 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 - L2^2*cosd(theta1 + 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L3)^2 + L3^2*cosd(theta1 + theta2 + theta3 - conj(theta2))*abs(L1)^2*abs(L2)^2 - L3^2*abs(L1)^2*abs(L2)^2*cosd(theta1 + theta3 + 2*real(theta2)) - L1*L3*cosd(theta1 + conj(theta2))*abs(L1)^2*abs(L2)^2 + L1*L2*cosd(conj(theta2) - theta1 + conj(theta3))*abs(L1)^2*abs(L3)^2 - L1*L3*cosd(theta1 + theta2 + theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2 - L2*L3*cosd(theta1 + 2*real(theta2))*abs(L1)^2*abs(L2)^2 + L1*L3*cosd(theta1 - conj(theta2))*abs(L1)^2*abs(L2)^2 - L2*L3*cosd(theta1 + 2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2 + L2*L3*cosd(theta1 + theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 + L1*L3*abs(L2)^2*abs(L3)^2*cosd(theta1 + theta2 + 2*real(theta3)) + L2*L3*abs(L1)^2*abs(L2)^2*cosd(theta1 + theta2 - conj(theta2)) - L1*L2*abs(L1)^2*abs(L3)^2*cosd(theta1 + conj(theta2) + conj(theta3)))/(2*(L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta2)*sind(theta3) + L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta3)*sind(theta2) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + L1*L2*L3*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*sind(theta2) + 2*L1*L2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*sind(theta3) + L1*L2^2*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta2) + L1*L2^2*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta2) + L2^2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta3) + L2^2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2)));
                                                                                                                                       -(L1^2*sind(theta1 + conj(theta3))*abs(L2)^2*abs(L3)^2 - L2^2*sind(theta1 + theta2 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 + L2^2*sind(theta1 + 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L3)^2 - L1^2*sind(theta1 - conj(theta3))*abs(L2)^2*abs(L3)^2 - 2*L1*L2*abs(L2)^2*abs(L3)^2*sind(theta1 + theta2 - conj(theta3)) + L1*L2*abs(L1)^2*abs(L3)^2*sind(theta1 + conj(theta2) + conj(theta3)) + L1*L2*sind(conj(theta2) - theta1 + conj(theta3))*abs(L1)^2*abs(L3)^2 - 2*L1*L3*sind(theta1 + theta2 + theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2 + 2*L1*L2*sind(theta1 + theta2 + conj(theta3))*abs(L2)^2*abs(L3)^2 + L2*L3*sind(theta1 + 2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2 - L2*L3*sind(theta1 + theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 + 2*L1*L3*abs(L2)^2*abs(L3)^2*sind(theta1 + theta2 + 2*real(theta3)))/(2*(L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta2)*sind(theta3) + L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta3)*sind(theta2) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + L1*L2*L3*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*sind(theta2) + 2*L1*L2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*sind(theta3) + L1*L2^2*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta2) + L1*L2^2*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta2) + L2^2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta3) + L2^2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2))),                                                                                                                              (L1^2*cosd(theta1 + conj(theta3))*abs(L2)^2*abs(L3)^2 - L2^2*cosd(theta1 + theta2 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 + L2^2*cosd(theta1 + 2*real(theta2) + conj(theta3))*abs(L1)^2*abs(L3)^2 - L1^2*cosd(theta1 - conj(theta3))*abs(L2)^2*abs(L3)^2 - L1*L2*cosd(conj(theta2) - theta1 + conj(theta3))*abs(L1)^2*abs(L3)^2 - 2*L1*L3*cosd(theta1 + theta2 + theta3 - conj(theta3))*abs(L2)^2*abs(L3)^2 + 2*L1*L2*cosd(theta1 + theta2 + conj(theta3))*abs(L2)^2*abs(L3)^2 + L2*L3*cosd(theta1 + 2*real(theta2) + 2*real(theta3))*abs(L1)^2*abs(L3)^2 - L2*L3*cosd(theta1 + theta2 + theta3 - conj(theta2) - conj(theta3))*abs(L1)^2*abs(L3)^2 + 2*L1*L3*abs(L2)^2*abs(L3)^2*cosd(theta1 + theta2 + 2*real(theta3)) - 2*L1*L2*abs(L2)^2*abs(L3)^2*cosd(theta1 + theta2 - conj(theta3)) + L1*L2*abs(L1)^2*abs(L3)^2*cosd(theta1 + conj(theta2) + conj(theta3)))/(2*(L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta2)*sind(theta3) + L1*L3^2*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*cosd(theta3)*sind(theta2) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + L1^2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + L1*L2*L3*sind(conj(theta2))*abs(L1)^2*abs(L2)^2*sind(theta2) + 2*L1*L2*L3*sind(conj(theta3))*abs(L2)^2*abs(L3)^2*sind(theta3) + L1*L2^2*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta2) + L1*L2^2*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta2) + L2^2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*sind(theta3) + L2^2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta2))*sind(conj(theta3))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta2)*sind(theta3) + 2*L1*L2*L3*cosd(conj(theta3))*sind(conj(theta2))*abs(L1)^2*abs(L3)^2*cosd(theta3)*sind(theta2)))];
                                                                                                                                   
                                                                                                                                   
 